<div>
    <div class="d-flex align-items-center justify-content-between">
        <span class="font-20 fw-500">Mappings</span>
        <button type="button" class="btn btn-link p-0">
            <span class="dsi dsi-close text-dark ignore-outside" (click)="cancel()"></span>
        </button>
    </div>
    <div class="mapping-container my-3 border rounded">
        <div class="d-flex align-items-center justify-content-end">
            <button type="button" class="btn btn-link d-flex align-items-center" (click)="doFuzzyMapping()">
                <span class="dsi dsi-mapping mr-2"></span>
                <span>Fuzzy Mappings</span>
            </button>
            <button type="button" class="btn btn-link d-flex align-items-center" (click)="doClearMapping()">
                <span class="dsi dsi-ban mr-2"></span>
                <span>Clear Mappings</span>
            </button>
        </div>
        <div class="mapping-box d-flex align-items-stretch p-4">
            <div class="source-list">
                <ng-container *ngFor="let node of nodeList;let i=index">
                    <div *ngIf="node._id!=currNode._id" class="border mb-3 rounded p-2">
                        <div>
                            <div *ngIf="node.type=='FILE'"
                                class="node-item border-bottom pb-2 mb-2 d-flex align-items-center hover ">
                                <span class="node-icon font-16 fw-400 dsi dsi-file mr-2"></span>
                                <span class="font-13 fw-400 text-secondary">File Agent</span>
                            </div>
                            <div *ngIf="node.type=='API'"
                                class="node-item border-bottom pb-2 mb-2 d-flex align-items-center hover ">
                                <span class="node-icon font-16 fw-400 dsi dsi-invoke-api mr-2"></span>
                                <span class="font-13 fw-400 text-secondary">Invoke API</span>
                            </div>
                            <div *ngIf="node.type=='CONNECTOR'"
                                class="node-item border-bottom pb-2 mb-2 d-flex align-items-center hover ">
                                <span class="node-icon font-16 fw-400 dsi dsi-connector mr-2"></span>
                                <span class="font-13 fw-400 text-secondary">Connector</span>
                            </div>
                            <div *ngIf="node.type=='DATASERVICE'"
                                class="node-item border-bottom pb-2 mb-2 d-flex align-items-center hover ">
                                <span class="node-icon font-16 fw-400 dsi dsi-data-service mr-2"></span>
                                <span class="font-13 fw-400 text-secondary">Data Service</span>
                            </div>
                            <div *ngIf="node.type=='FUNCTION'"
                                class="node-item border-bottom pb-2 mb-2 d-flex align-items-center hover ">
                                <span class="node-icon font-16 fw-400 dsi dsi-function mr-2"></span>
                                <span class="font-13 fw-400 text-secondary">Function</span>
                            </div>
                            <div *ngIf="node.type=='DEDUPE'"
                                class="node-item border-bottom pb-2 mb-2 d-flex align-items-center hover">
                                <span class="node-icon font-16 fw-400 dsi dsi-copy mr-2"></span>
                                <span class="font-13 fw-400 text-secondary">De-Dupe</span>
                            </div>
                            <div *ngIf="node.type=='CONFLICT'"
                                class="node-item border-bottom pb-2 mb-2 d-flex align-items-center hover">
                                <span class="node-icon font-16 fw-400 dsi dsi-insight mr-2"></span>
                                <span class="font-13 fw-400 text-secondary">Conflict</span>
                            </div>
                            <div *ngIf="node.type=='MAPPING'"
                                class="node-item border-bottom pb-2 mb-2 d-flex align-items-center hover ">
                                <span class="node-icon font-16 fw-400 dsi dsi-mapping mr-2"></span>
                                <span class="font-13 fw-400 text-secondary">Mapping</span>
                            </div>
                            <div *ngIf="node.type=='CODEBLOCK'"
                                class="node-item border-bottom pb-2 mb-2 d-flex align-items-center hover ">
                                <span class="node-icon font-16 fw-400 dsi dsi-console mr-2 text-secondary"></span>
                                <span class="font-13 fw-400 text-secondary">Code Block</span>
                            </div>
                            <div *ngIf="node.type=='UNWIND'"
                                class="node-item border-bottom pb-2 mb-2 d-flex align-items-center hover ">
                                <span class="node-icon font-16 fw-400 dsi dsi-expand mr-2"></span>
                                <span class="font-13 fw-400 text-secondary">Change Root</span>
                            </div>
                            <div *ngIf="node.type=='RESPONSE'"
                                class="node-item border-bottom pb-2 mb-2 d-flex align-items-center hover ">
                                <span class="node-icon font-16 fw-400 dsi dsi-response mr-2"></span>
                                <span class="font-13 fw-400 text-secondary">Response</span>
                            </div>
                        </div>
                        <div class="font-14 fw-500 mb-2">{{node.name}}</div>
                        <odp-source-selector [nodeList]="nodeList" [index]="i"></odp-source-selector>
                    </div>
                </ng-container>
            </div>
            <svg #svgCanvas class="mapping-paths" [ngStyle]="svgStyle" (click)="selectedPath=null;">
                <g *ngFor="let p of pathList;let i=index;">
                    <path class="transparent-path" [attr.d]="p.path" (click)="selectPath($event,p,i)" />
                    <path [class.selected]="isPathSelected(p)" [attr.d]="p.path" (click)="selectPath($event,p,i)" />
                    <g *ngIf="isPathSelected(p)" [ngStyle]="getDeleteIconStyle(p)">
                        <rect x="0" y="0" width="18" height="18" rx="6" class="delete-rect"
                            (click)="deletePath($event,p,i)" />
                        <foreignObject x="0" y="3" width="18" height="18">
                            <span xmlns="http://www.w3.org/1999/xhtml" (click)="deletePath($event,p,i)"
                                class="text-wrap d-flex justify-content-center text-center hover font-10 dsi dsi-trash text-danger"></span>
                        </foreignObject>
                    </g>

                </g>
            </svg>
            <div class="target-list">
                <div *ngFor="let item of allTargets;let i=index">
                    <odp-target-fields [allSources]="allSources" [definition]="item" [index]="i"
                        [currNode]="currNode"></odp-target-fields>
                </div>
            </div>
        </div>
        <!-- <svg #svgCanvas class="mapping-svg w-100">
            <g class="source-fields">
                <g *ngFor="let item of allSources;let i=index">
                    <g odp-source-fields [index]="i" [definition]="item"></g>
                </g>
            </g>
            <g class="target-fields">
                <g *ngFor="let item of allTargets;let i=index">
                    <g odp-target-fields [allSources]="allSources" [allTargets]="allTargets" [index]="i"
                        [definition]="item"></g>
                </g>
            </g>
        </svg> -->
    </div>
    <div class="d-flex justify-content-end">
        <button type="button" class="btn btn-primary btn-min-width" (click)="done()">Done</button>
    </div>
</div>